(function(){"use strict";var e={5020:function(e,t,o){var n=o(5130),r=o(6768);function s(e,t){const o=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.Wv)(o)}var i=o(1241);const a={},c=(0,i.A)(a,[["render",s]]);var l=c,d=o(4458);(0,d.k)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});var p=o(1387),h=(o(8111),o(2489),o(4232));const u={class:"app"},m={class:"health__bar"},y={class:"info"},_={class:"info__item"},b={class:"info__item"},f={class:"info__item"},g={class:"info__item"},v={class:"leftbar"},w=["disabled"],k={class:"leftbar__textbox"},x=["innerHTML"],P={key:1,class:"leftbar__text--defeat"},C={class:"rightbar"},L={class:"rightbar__tab-wrapper"},T=["onClick","onKeyup"],B={class:"rightbar__component"};function M(e,t,o,s,i,a){return(0,r.uX)(),(0,r.CE)("div",u,[(0,r.Lk)("div",{class:"health",onMouseenter:t[0]||(t[0]=e=>i.showHealthPoints=!0),onMouseleave:t[1]||(t[1]=e=>i.showHealthPoints=!1),onFocusin:t[2]||(t[2]=e=>i.showHealthPoints=!0),onFocusout:t[3]||(t[3]=e=>i.showHealthPoints=!1),tabindex:"0"},[(0,r.Lk)("div",m,[(0,r.Lk)("div",{class:"health__bar--red",style:(0,h.Tr)({width:`calc(${i.health}% )`,"--before-width":(100-i.health)/i.health*100+"%"})},null,4),t[11]||(t[11]=(0,r.Lk)("p",{class:"health__text"},"терпение инвесторов",-1)),(0,r.bo)((0,r.Lk)("p",{class:"health__points"},(0,h.v_)(i.health)+"/100",513),[[n.aG,i.showHealthPoints]])])],32),(0,r.Lk)("div",y,[(0,r.Lk)("p",_,"Период: "+(0,h.v_)(i.period),1),(0,r.Lk)("p",b,"Деньги: "+(0,h.v_)(i.money),1),(0,r.Lk)("p",f,"Функция спроса: p = "+(0,h.v_)(i.demand)+" - Q",1),(0,r.Lk)("p",g,"Затраты на производство: "+(0,h.v_)(i.costs),1)]),(0,r.Lk)("div",v,[(0,r.Lk)("button",{class:"leftbar__button",onClick:t[4]||(t[4]=(...e)=>a.endPeriod&&a.endPeriod(...e)),onKeyup:t[5]||(t[5]=(0,n.jR)(((...e)=>a.endPeriod&&a.endPeriod(...e)),["enter"])),disabled:i.health<=0}," завершить период ",40,w),(0,r.Lk)("div",k,[i.health>0?((0,r.uX)(),(0,r.CE)("p",{key:0,class:"leftbar__text",innerHTML:i.longText.replace(/\n/g,"<br>")},null,8,x)):(0,r.Q3)("",!0),i.health<=0?((0,r.uX)(),(0,r.CE)("p",P," Вы проиграли. Инвесторы потеряли терпение. ")):(0,r.Q3)("",!0)])]),(0,r.Lk)("div",C,[(0,r.Lk)("div",L,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(i.tabs,(e=>((0,r.uX)(),(0,r.CE)("p",{class:(0,h.C4)(["rightbar__tab",e.pressed?"rightbar__tab--chosen":""]),key:e.name,onClick:t=>a.changeTab(e),role:"button",tabindex:"0",onKeyup:(0,n.jR)((t=>a.changeTab(e)),["enter"])},(0,h.v_)(e.name),43,T)))),128))]),(0,r.Lk)("div",B,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(i.tabs.filter((e=>e.pressed)),(e=>((0,r.uX)(),(0,r.Wv)((0,r.$y)(e.component),{key:e.name,onUpdateProduction:t[6]||(t[6]=e=>i.productionAmount=e),onPriceIncrease:a.handlePriceIncrease,onGameReset:a.handleGameReset,"onUpdate:money":t[7]||(t[7]=e=>i.money=e),"onUpdate:propertyPrice":t[8]||(t[8]=e=>i.propertyPrice=e),"onUpdate:costs":t[9]||(t[9]=e=>i.costs=e),PropertyPrice:i.propertyPrice,learningMode:i.learningMode,"onUpdate:learningMode":t[10]||(t[10]=e=>i.learningMode=e)},null,40,["onPriceIncrease","onGameReset","PropertyPrice","learningMode"])))),128))])])])}o(1701);const E={class:"production"},O={class:"production__item"},j={for:"productionAmount"},A={class:"production__item price"},I={for:"price"};function $(e,t,o,s,i,a){return(0,r.uX)(),(0,r.CE)("div",E,[(0,r.Lk)("div",O,[(0,r.Lk)("label",j,[(0,r.bo)((0,r.Lk)("input",{type:"text",id:"productionAmount","onUpdate:modelValue":t[0]||(t[0]=e=>i.productionAmount=e),onInput:t[1]||(t[1]=(...e)=>a.emitProductionAmount&&a.emitProductionAmount(...e))},null,544),[[n.Jo,i.productionAmount]]),t[4]||(t[4]=(0,r.eW)(" Сколько произвести в этот период? "))])]),(0,r.Lk)("div",A,[(0,r.Lk)("label",I,[(0,r.bo)((0,r.Lk)("input",{type:"text",id:"price","onUpdate:modelValue":t[2]||(t[2]=e=>i.priceIncrease=e)},null,512),[[n.Jo,i.priceIncrease]]),t[5]||(t[5]=(0,r.eW)(" На сколько увеличить цену производства? "))]),(0,r.Lk)("button",{class:"price__button",onClick:t[3]||(t[3]=(...e)=>a.emitPriceIncrease&&a.emitPriceIncrease(...e))},"увеличить")])])}var S={name:"ProductionTab",data(){return{productionAmount:0,priceIncrease:0}},methods:{emitProductionAmount(){this.$emit("update-production",this.productionAmount)},emitPriceIncrease(){this.$emit("price-increase",Number(this.priceIncrease))}}};const X=(0,i.A)(S,[["render",$],["__scopeId","data-v-47938d45"]]);var F=X;const G={class:"lobbying"},H=["onClick","disabled"],N={class:"lobbying__text"},J={class:"lobbying__text--price"};function R(e,t,o,n,s,i){return(0,r.uX)(),(0,r.CE)("div",G,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.policies,((e,t)=>((0,r.uX)(),(0,r.CE)("div",{class:"lobbying__item",key:t},[(0,r.Lk)("button",{class:"lobbying__button",onClick:e=>i.invest(t),disabled:e.invested}," инвестировать ",8,H),(0,r.Lk)("p",N,[(0,r.eW)((0,h.v_)(e.name)+" ",1),(0,r.Lk)("span",J," ("+(0,h.v_)(e.price)+") ",1)])])))),128))])}var U={name:"LobbyingTab",data(){return{policies:[{name:"Создать лицензии для деятельности в этой сфере",price:1e3,invested:!1,one_time_payment:1e3},{name:"Усложнить порядок регистрации предприятий и фирм",price:2e3,invested:!1,one_time_payment:2e3},{name:"Усложнить процедуру отвода земельных участков и предоставление служебных помещений",price:3e3,invested:!1,one_time_payment:3e3}]}},methods:{async invest(e){this.policies[e].invested=!0;try{const t=await fetch("http://127.0.0.1:5000/invest",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({investedMoney:this.policies[e].price,action:this.policies[e].one_time_payment,isInvested:this.policies[e].invested})}),o=await t.json();void 0!==o.isInvested&&(this.policies[e].invested=o.isInvested),void 0!==o.newMoney&&this.$emit("update:money",o.newMoney)}catch(t){console.error("Error sending production amount:",t)}}}};const q=(0,i.A)(U,[["render",R],["__scopeId","data-v-6e78be7a"]]);var D=q;const K={class:"property"},W={class:"property__info"},Q={class:"property__item"},V={class:"property__item"},z={class:"property__item"},Y={class:"property__item"};function Z(e,t,o,n,s,i){return(0,r.uX)(),(0,r.CE)("div",K,[(0,r.Lk)("div",W,[(0,r.Lk)("p",Q,"куплено участков: "+(0,h.v_)(s.playersPlots.length),1),(0,r.Lk)("p",V,"стоимость нового участка: "+(0,h.v_)(o.PropertyPrice),1),(0,r.Lk)("p",z,"налог при покупке: "+(0,h.v_)(i.purchaseTax),1),(0,r.Lk)("p",Y,"налоги на имущество в следующем периоде: "+(0,h.v_)(i.propertyTax),1)]),(0,r.Lk)("button",{class:"property__button",onClick:t[0]||(t[0]=(...e)=>i.buyProperty&&i.buyProperty(...e))}," Купить землю ")])}o(8237);var ee={name:"PropertyTab",props:{PropertyPrice:{type:[String,Number,Object],required:!1}},data(){return{playersPlots:[]}},mounted(){fetch("http://127.0.0.1:5000/data").then((e=>e.json())).then((e=>{this.playersPlots=e.playersPlots})).catch((e=>console.error("Error fetching message:",e)))},computed:{purchaseTax(){return(.005*this.PropertyPrice).toFixed(2)},propertyTax(){return(.005*this.playersPlots.reduce(((e,t)=>e+t),0)).toFixed(2)}},methods:{async buyProperty(){try{const e=await fetch("http://127.0.0.1:5000/buy_property",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plots:this.playersPlots})}),t=await e.json();this.playersPlots=t.playersPlots,void 0!==t.money&&this.$emit("update:money",t.money),void 0!==t.property_price&&this.$emit("update:property-price",t.property_price),void 0!==t.costs&&this.$emit("update:costs",t.costs)}catch(e){console.error("Error buying property:",e)}}}};const te=(0,i.A)(ee,[["render",Z],["__scopeId","data-v-079d47ff"]]);var oe=te;const ne={for:"learningMode"},re=["checked"];function se(e,t,o,n,s,i){return(0,r.uX)(),(0,r.CE)("div",null,[(0,r.Lk)("label",ne,[(0,r.Lk)("input",{type:"checkbox",name:"learningMode",id:"learningMode",checked:o.learningMode,onChange:t[0]||(t[0]=e=>i.updateLearningMode(e.target.checked))},null,40,re),t[2]||(t[2]=(0,r.eW)(" Режим обучения "))]),t[3]||(t[3]=(0,r.Lk)("br",null,null,-1)),(0,r.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>i.resetGame&&i.resetGame(...e))}," начать игру сначала ")])}var ie={name:"SettingsTab",props:{learningMode:{type:Boolean,default:!1}},methods:{async resetGame(){try{const e=await fetch("http://127.0.0.1:5000/reset",{method:"POST"}),t=await e.json();this.$emit("game-reset",t),console.log("Игра сброшена",t)}catch(e){console.error("Ошибка при сбросе игры:",e)}},updateLearningMode(e){this.$emit("update:learning-mode",e)}}};const ae=(0,i.A)(ie,[["render",se]]);var ce=ae,le=o(4874),de=o.n(le);const pe=[{title:'<h3 class="alert__header">Добро пожаловать в игру!</h3>',html:'<p class="alert__text">В этой игре вы выполняете роль фирмы-монополиста. Ваша цель - управлять производством и некоторыми другими аспектами бизнеса, чтобы не допустить вход конкурентов на рынок и их укрепления там.</p>',confirmButtonText:"Хорошо",confirmButtonColor:"#3085d6",draggable:!0,showCloseButton:!0},{title:'<h3 class="alert__header">Нужно обучение?</h3>',html:'<p class="alert__text">выбор потом можно будет поменять в настройках</p>',showCloseButton:!0,showDenyButton:!0,confirmButtonText:"Да",denyButtonText:"Нет",icon:"question",confirmButtonColor:"#0db400",cancelButtonColor:"#c30000"},{title:'<h3 class="alert__header">Обучение</h3>',html:'<p class="alert__text">Механика игры построена на простой функции спроса и стоимости производства. Обе эти величены вы можете найти в правом верхнем углу экрана. Его можно пролистать по-горизонтали, если не всё видно.</p>',confirmButtonText:"Далее",confirmButtonColor:"#3085d6",showCloseButton:!0},{title:'<h3 class="alert__header">Как производить оптимально?</h3>',html:'<p class="alert__text">Эта игра считает прибыль по формуле:</p><div id="latex-formula">$$\\pi(q) = (100 - Q)q - cq$$</div><p class="alert__text">где содержимое скобок - функция спроса; Q - количество произведённой продукции вами и вашим оппонентом; c - стоимость производства одной единицы товара, а q - то, сколько товара произвели вы. Произведя вычисления с помощью производных вы можете найти оптимальное количество продукта</p>',confirmButtonText:"Понятно",showCancelButton:!0,cancelButtonText:"Назад",showCloseButton:!0,confirmButtonColor:"#3085d6",footer:'<p class="alert__text">Если вы не знате, как это рассчитывается, то можете обратиться к этой <a href="https://ecson.ru/economics/market-structure-analysis/zadacha-152.raschyot-optimalnogo-objoma-vypuska.tseny-i-pribyli-monopolista.html" target="_blank" rel="noopener noreferrer">статье</a></p>',didOpen:()=>{window.MathJax&&window.MathJax.typesetPromise()}},{title:'<h3 class="alert__header">Попробуйте сами!</h3>',html:'<p class="alert__text">Теперь вы можете применить полученные знания на практике. Удачи в игре!</p>',confirmButtonText:"Начать",confirmButtonColor:"#3085d6",showCloseButton:!0,stop:!0},{title:'<h3 class="alert__header">Хорошая работа!</h3>',html:'<p class="alert__text">Вы получили первую прибыль! Теперь попробуйте накопить денег до 9 периода.</p>',confirmButtonText:"Ок",confirmButtonColor:"#3085d6",showCloseButton:!0,stop:!0},{title:'<h3 class="alert__header">Обратите внимание!</h3>',html:'<p class="alert__text">На рынок в следующем периоде войдёт оппонент. Теперь вам нужно учитывать его действия при планировании производства и стратегии ценообразования. Следите за изменениями на рынке и адаптируйте свою стратегию! Также посмотрите в другие вкладки справа. Они помогут вам против конкурентов</p>',confirmButtonText:"Понятно",confirmButtonColor:"#f39c12",icon:"warning",showCloseButton:!0,stop:!0},{title:'<h3 class="alert__header">Лоббирование</h3>',html:'<p class="alert__text">В игре доступна опция лоббирования. Вы можете использовать её, чтобы повысить стоимость вхождения для конкурентов. Если у оппонента не найдётся денег чтобы "оплатить порог", то он не войдёт на рынок в тот период</p>',confirmButtonText:"Понятно",confirmButtonColor:"#3085d6",showCloseButton:!0,stop:!0},{title:'<h3 class="alert__header">Собственность</h3>',html:'<p class="alert__text">В игре доступна опция покупки собственности. Покупка собственности увеличивает ваши затраты в период в виде налогов, но в обмен увеличивает порог вхождения для оппонента.</p>',footer:'<a class="alert__text" id="why-property-link" style="cursor:pointer;">Почему так?</a>',confirmButtonText:"Далее",confirmButtonColor:"#3085d6",showCloseButton:!0,stop:!0,didOpen:()=>{const e=document.getElementById("why-property-link");e&&(e.onclick=()=>{de().fire({title:'<h3 class="alert__header">Это нестратегический барьер</h3>',html:'<p class="alert__text">Состояние инфраструктуры рынка в виде наличия и степени развитости транспортной системы и системы хранения товаров в регионе или стране в целом оказывает влияние на возможность перемещения товаров в рамках территорий и, следовательно, на наличие или отсутствие местных локальных рынков. Чем лучше развита инфраструктура рынка, тем быстрее товары могут перемещаться по территории, тем меньше вероятность возникновения замкнутого локального рынка, и тем более открытым будет продуктовый рынок в целом. Отсутствие нормально функционирующей транспортной системы и системы хранения товаров может препятствовать проникновению новых фирм на рынки и формированию достаточно замкнутых территориально ограниченных рыночных пространств.</p>',confirmButtonText:"Понятно",confirmButtonColor:"#3085d6",showCloseButton:!0})})}}];let he=0;function ue(e,t=-1,o=!1){if(o&&(he=0),!(he>=pe.length))return t>he?de().fire({...pe[t]}):de().fire({...pe[he]}).then((t=>{const o=pe[he];t.isConfirmed&&o&&!o.stop?(he+=1,e&&e(!0),ue(e)):t.isDismissed&&t.dismiss===de().DismissReason.cancel?(he-=1,ue(e)):(t.isDenied||t.isDismissed===de().DismissReason.close)&&(e&&e(!1),he=0),o&&o.stop&&(he+=1)}))}var me={components:{ProductionTab:F,LobbyingTab:D,PropertyTab:oe,SettingsTab:ce},name:"HomeView",data(){return{learningMode:!0,propertyPrice:400,showHealthPoints:!1,longText:"",health:100,period:1,money:0,demand:"",costs:0,tabs:[{name:"Производство",component:"production-tab",pressed:1,index:0,new:!1},{name:"Лоббирование",component:"lobbying-tab",pressed:0,index:1,new:!0},{name:"Собственность",component:"property-tab",pressed:0,index:2,new:!0},{name:"Настройки",component:"settings-tab",pressed:0,index:3,new:!1}],test:"",productionAmount:""}},methods:{async endPeriod(){this.period+=1,console.log("health",this.health);try{const e=await fetch("http://127.0.0.1:5000/production",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productionAmount:this.productionAmount,longText:this.longText,health:this.health})}),t=await e.json();void 0!==t.money&&(this.money=t.money),void 0!==t.costs&&(this.costs=t.costs),void 0!==t.long_text&&(this.longText=t.long_text),void 0!==t.health&&(this.health=t.health),void 0!==t.demand&&(this.demand=t.demand),void 0!==t.property_price&&(this.propertyPrice=t.property_price),console.log("Server response:",t)}catch(e){console.error("Error sending production amount:",e)}2!==this.period&&9!==this.period||!this.learningMode||ue(this.setLearningMode)},changeTab(e){this.tabs=this.tabs.map((t=>(t.name===e.name&&!0===t.new&&this.learningMode&&ue(this.setLearningMode,6+e.index),{...t,pressed:t.name===e.name?1:0,new:t.name!==e.name&&t.new})))},handleGameReset(e){this.propertyPrice=e.property_price,this.health=e.health,this.period=e.period,this.money=e.money,this.demand=e.demand,this.costs=e.costs,this.longText=e.long_text,1===this.period&&this.learningMode&&(console.log(this.learningMode),ue(this.setLearningMode,-1,!0)),this.tabs=[{name:"Производство",component:"production-tab",pressed:0,index:0,new:!1},{name:"Лоббирование",component:"lobbying-tab",pressed:0,index:1,new:!0},{name:"Собственность",component:"property-tab",pressed:0,index:2,new:!0},{name:"Настройки",component:"settings-tab",pressed:1,index:3,new:!1}]},handleGlobalEnter(e){"Enter"===e.key&&this.health>0&&this.endPeriod()},async handlePriceIncrease(e){try{const t=await fetch("http://127.0.0.1:5000/increase_cost",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:e})}),o=await t.json();this.costs=o.costs}catch(t){console.error("Failed to increase cost:",t)}},setLearningMode(e){this.learningMode=e}},mounted(){fetch("http://127.0.0.1:5000/data").then((e=>e.json())).then((e=>{this.test=e,this.costs=e.costs,this.money=e.money,this.demand=e.demand,this.health=e.health,this.period=e.period,this.propertyPrice=e.property_price,this.longText=e.long_text,1===this.period&&this.learningMode&&(console.log(this.learningMode),ue(this.setLearningMode))})).catch((e=>console.error("Error fetching message:",e))),window.addEventListener("keydown",this.handleGlobalEnter)},beforeUnmount(){window.removeEventListener("keydown",this.handleGlobalEnter)}};const ye=(0,i.A)(me,[["render",M]]);var _e=ye;const be=[{path:"/",name:"home",component:_e}],fe=(0,p.aE)({history:(0,p.Bt)(),routes:be});var ge=fe,ve=o(782),we=(0,ve.y$)({state:{},getters:{},mutations:{},actions:{},modules:{}});(0,n.Ef)(l).use(we).use(ge).mount("#app")}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,o),s.exports}o.m=e,function(){var e=[];o.O=function(t,n,r,s){if(!n){var i=1/0;for(d=0;d<e.length;d++){n=e[d][0],r=e[d][1],s=e[d][2];for(var a=!0,c=0;c<n.length;c++)(!1&s||i>=s)&&Object.keys(o.O).every((function(e){return o.O[e](n[c])}))?n.splice(c--,1):(a=!1,s<i&&(i=s));if(a){e.splice(d--,1);var l=r();void 0!==l&&(t=l)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[n,r,s]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,s,i=n[0],a=n[1],c=n[2],l=0;if(i.some((function(t){return 0!==e[t]}))){for(r in a)o.o(a,r)&&(o.m[r]=a[r]);if(c)var d=c(o)}for(t&&t(n);l<i.length;l++)s=i[l],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(d)},n=self["webpackChunkprice_war"]=self["webpackChunkprice_war"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[504],(function(){return o(5020)}));n=o.O(n)})();
//# sourceMappingURL=app.fc7cad34.js.map